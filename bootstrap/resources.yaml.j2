{% for namespace in ['security', 'network', 'flux-system'] %}
---
# yaml-language-server: $schema=https://raw.githubusercontent.com/yannh/kubernetes-json-schema/refs/heads/master/master/namespace-v1.json
apiVersion: v1
kind: Namespace
metadata:
  name: {{ namespace }}
{% endfor %}
---
# yaml-language-server: $schema=https://raw.githubusercontent.com/yannh/kubernetes-json-schema/refs/heads/master/master/secret-v1.json
apiVersion: v1
kind: Secret
metadata:
  name: bitwarden
  namespace: security
  labels:
    reconcile.external-secrets.io/managed: 'true'
stringData:
  {{ ENV['bitwarden'] | indent(2) | safe }}
---
# yaml-language-server: $schema=https://raw.githubusercontent.com/yannh/kubernetes-json-schema/refs/heads/master/master/secret-v1.json
apiVersion: v1
kind: Secret
metadata:
  name: tholinka-dev-tls
  namespace: network
  annotations:
    cert-manager.io/alt-names: '*.tholinka.dev,tholinka.dev'
    cert-manager.io/certificate-name: tholinka-dev
    cert-manager.io/common-name: ''
    cert-manager.io/ip-sans: ''
    cert-manager.io/issuer-group: ''
    cert-manager.io/issuer-kind: ClusterIssuer
    cert-manager.io/issuer-name: letsencrypt
    cert-manager.io/uri-sans: ''
  labels:
    controller.cert-manager.io/fao: 'true'
type: kubernetes.io/tls
# this get saved as json, but yaml is a super-set of json so we can just directly import it :)
data: {{ ENV['lets_encrypt_tls'] | safe }}
